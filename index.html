<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CDN Yuki-Wabot</title>
  <link rel="preconnect" href="https://cdn.yuki-wabot.my.id" crossorigin>
  <link rel="dns-prefetch" href="//cdn.yuki-wabot.my.id">
  <style>
    :root {
      --bg:#0b0f14;--fg:#e7eef7;--muted:#8ea0b3;--accent:#6ee7ff;--card:#11161d;--border:#1f2a37
    }
    *{box-sizing:border-box}
    body{margin:0;font:14px/1.5 system-ui;background:var(--bg);color:var(--fg)}
    .wrap{max-width:920px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:18px;margin:0}
    .badge{padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--card);color:var(--muted)}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;margin:12px 0}
    input,button{width:100%;border-radius:10px;border:1px solid var(--border);background:#0d131a;color:var(--fg);padding:12px 14px}
    button{cursor:pointer;background:#0f1720}
    button.primary{background:linear-gradient(90deg,#22d3ee 0%,#60a5fa 100%);color:#041018;border:none;font-weight:600}
    .status{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted)}
    .dot{width:10px;height:10px;border-radius:50%}
    .ok{background:#67e8a9}.warn{background:#fbbf24}.err{background:#f87171}
    .small{font-size:12px;color:var(--muted)}
    .pill{padding:6px 8px;border:1px dashed var(--border);border-radius:8px;background:#0c1218;margin-top:6px}
    a{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>CDN de Yuki‑Wabot</h1>
      <span class="badge">main / root</span>
    </header>
    <div class="card">
      <div class="small">Dominio</div>
      <div>https://cdn.yuki-wabot.my.id</div>
    </div>
    <div class="card">
      <div class="small">Ruta del archivo</div>
      <input id="pathInput" placeholder="/bot-image/abcd.png o /abcd.png">
      <button id="watchBtn" class="primary">Verificar</button>
      <div id="watchStatus" class="status" style="margin-top:10px">
        <span class="dot warn"></span><span>Esperando URL…</span>
      </div>
      <div id="result" style="margin-top:10px"></div>
    </div>
  </div>
  <script>
    const $=s=>document.querySelector(s)
    async function waitFor200(url,{maxTime=60000,startDelay=1500}={}) {
      const t0=performance.now()
      let delay=startDelay
      while(performance.now()-t0<maxTime){
        try{
          const r=await fetch(url,{method:'HEAD',cache:'no-cache'})
          if(r.status===200){$('#watchStatus').innerHTML='<span class="dot ok"></span><span>Disponible</span>';return true}
          if(r.status===404){$('#watchStatus').innerHTML='<span class="dot warn"></span><span>No disponible aún…</span>'}
          else{$('#watchStatus').innerHTML='<span class="dot warn"></span><span>Estado '+r.status+'</span>'}
        }catch(e){$('#watchStatus').innerHTML='<span class="dot err"></span><span>Error de conexión</span>'}
        await new Promise(res=>setTimeout(res,delay))
        delay=Math.min(delay*1.7,5000)
      }
      $('#watchStatus').innerHTML='<span class="dot err"></span><span>Tiempo agotado</span>'
      return false
    }
    $('#watchBtn').addEventListener('click',async()=>{
      const path=($('#pathInput').value||'').trim()
      if(!path.startsWith('/')){ $('#result').innerHTML='<div class="pill">La ruta debe comenzar con /</div>'; return }
      const url=`${location.origin}${path}`
      $('#result').innerHTML=`<div class="pill">URL: <a href="${url}" target="_blank">${url}</a></div>`
      const ok=await waitFor200(url)
      if(ok){$('#result').innerHTML+=`<div class="pill">Listo: <a href="${url}" target="_blank">${url}</a></div>`}
    })
  </script>
</body>
</html>
